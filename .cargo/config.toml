[profile.release]
opt-level = "z"        # 最小体积优化
lto = true             # 链接时优化
codegen-units = 1      # 单代码生成单元
panic = "abort"        # panic 时直接终止，减少展开代码
strip = true           # 剥离调试符号（Rust 1.59+）

# 针对不同平台的特殊优化
[target.x86_64-pc-windows-msvc]
rustflags = ["-C", "link-arg=/OPT:REF", "-C", "link-arg=/OPT:ICF"]

[target.'cfg(target_os = "linux")']
rustflags = ["-C", "link-arg=-Wl,--gc-sections", "-C", "link-arg=-Wl,--strip-all"]